  Develop[m
* [32mDeveloper[m
  Local-version[m
  backup-before-reset[m
  backup-current-state[m
  clean-deploy[m
  main[m
  master[m
  [31mremotes/origin/HEAD[m -> origin/main
  [31mremotes/origin/Local-version[m
  [31mremotes/origin/clean-deploy[m
  [31mremotes/origin/main[m
[1mdiff --git a/main.py b/main.py[m
[1mindex 9dfc3b44..2e57b3a5 100644[m
[1m--- a/main.py[m
[1m+++ b/main.py[m
[36m@@ -237,20 +237,6 @@[m [masync def initialize_bot():[m
     # Initialize the application[m
     await application.initialize()[m
     [m
[31m-    # Set webhook URL for Cloud Run[m
[31m-    webhook_url = os.environ.get("WEBHOOK_URL")[m
[31m-    if webhook_url:[m
[31m-        try:[m
[31m-            await application.bot.set_webhook([m
[31m-                url=f"{webhook_url}/webhook",[m
[31m-                drop_pending_updates=True[m
[31m-            )[m
[31m-            print(f"‚úÖ Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: {webhook_url}/webhook")[m
[31m-        except Exception as e:[m
[31m-            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ webhook: {e}")[m
[31m-    else:[m
[31m-        print("‚ö†Ô∏è WEBHOOK_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è")[m
[31m-    [m
     print("üöÄ –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è webhook —Ä–µ–∂–∏–º–∞")[m
 [m
 @app.on_event("startup")[m
[36m@@ -309,32 +295,9 @@[m [masync def get_webhook():[m
     except Exception as e:[m
         raise HTTPException(status_code=500, detail=str(e))[m
 [m
[31m-async def process_update_background(update_data: dict):[m
[31m-    """Process Telegram update in background"""[m
[31m-    try:[m
[31m-        if not application:[m
[31m-            print("‚ùå –ë–æ—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏")[m
[31m-            return[m
[31m-        [m
[31m-        update = Update.de_json(update_data, application.bot)[m
[31m-        print(f"üìä Parsed update: {update}")[m
[31m-        [m
[31m-        if not update:[m
[31m-            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å update")[m
[31m-            return[m
[31m-        [m
[31m-        # Process the update[m
[31m-        await application.process_update(update)[m
[31m-        print("‚úÖ Update –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ")[m
[31m-        [m
[31m-    except Exception as e:[m
[31m-        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ñ–æ–Ω–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ update: {e}")[m
[31m-        import traceback[m
[31m-        traceback.print_exc()[m
[31m-[m
 @app.post("/webhook")[m
 async def webhook(request: Request):[m
[31m-    """Webhook endpoint for Telegram updates - returns immediately"""[m
[32m+[m[32m    """Webhook endpoint for Telegram updates"""[m
     try:[m
         print("üì® –ü–æ–ª—É—á–µ–Ω webhook –∑–∞–ø—Ä–æ—Å")[m
         [m
[36m@@ -355,10 +318,17 @@[m [masync def webhook(request: Request):[m
             print("‚ùå –ë–æ—Ç –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")[m
             return {"ok": True, "error": "Bot not initialized"}[m
         [m
[31m-        # Start background processing and return immediately[m
[31m-        asyncio.create_task(process_update_background(update_data))[m
[32m+[m[32m        update = Update.de_json(update_data, application.bot)[m
[32m+[m[32m        print(f"üìä Parsed update: {update}")[m
[32m+[m[41m        [m
[32m+[m[32m        if not update:[m
[32m+[m[32m            print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å update")[m
[32m+[m[32m            return {"ok": True}[m
[32m+[m[41m        [m
[32m+[m[32m        # Process the update[m
[32m+[m[32m        await application.process_update(update)[m
         [m
[31m-        print("‚úÖ Update –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Ñ–æ–Ω–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É")[m
[32m+[m[32m        print("‚úÖ Update –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ")[m
         return {"ok": True}[m
         [m
     except Exception as e:[m
