# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SERVICE_URL –¥–ª—è Cloud Run

## –ü—Ä–æ–±–ª–µ–º–∞

–í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
```
‚ö†Ô∏è SERVICE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - keep-alive –æ—Ç–∫–ª—é—á–µ–Ω
```

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ Google Cloud Run –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `SERVICE_URL`. Keep-alive –º–µ—Ö–∞–Ω–∏–∑–º –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∑–Ω–∞–Ω–∏—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ URL.

## –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ URL (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–ö–æ–¥ —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å URL —Å–µ—Ä–≤–∏—Å–∞ –∏–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Cloud Run:

```python
def get_service_url():
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º SERVICE_URL (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤—Ä—É—á–Ω—É—é)
    service_url = os.getenv("SERVICE_URL")
    if service_url:
        return service_url
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç—Ä–æ–∏–º URL –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Cloud Run
    region = os.getenv("K_REGION", "us-central1")
    service_name = os.getenv("K_SERVICE")
    project_id = os.getenv("GOOGLE_CLOUD_PROJECT")
    
    if service_name and project_id:
        return f"https://{service_name}-{project_id}.{region}.run.app"
    
    return None
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ SERVICE_URL

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤—Ä—É—á–Ω—É—é:

#### –ß–µ—Ä–µ–∑ Google Cloud Console:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Cloud Console](https://console.cloud.google.com/)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Cloud Run**
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å `ai-bot`
4. –ù–∞–∂–º–∏—Ç–µ **"Edit & Deploy New Revision"**
5. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **"Variables & Secrets"**
6. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
   - **Name**: `SERVICE_URL`
   - **Value**: `https://ai-bot-366461711404.asia-southeast1.run.app`

#### –ß–µ—Ä–µ–∑ gcloud CLI:

```bash
gcloud run services update ai-bot \
  --region=asia-southeast1 \
  --set-env-vars="SERVICE_URL=https://ai-bot-366461711404.asia-southeast1.run.app"
```

#### –ß–µ—Ä–µ–∑ cloudbuild.yaml:

```yaml
steps:
  - name: 'gcr.io/cloud-builders/gcloud'
    args:
      - 'run'
      - 'deploy'
      - 'ai-bot'
      - '--image'
      - 'gcr.io/$PROJECT_ID/ai-bot'
      - '--region'
      - 'asia-southeast1'
      - '--set-env-vars'
      - 'SERVICE_URL=https://ai-bot-366461711404.asia-southeast1.run.app'
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:

```
üíì Starting keep-alive ping to https://ai-bot-366461711404.asia-southeast1.run.app
üíì Keep-alive ping sent successfully.
```

## –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ keep-alive –≤—Å–µ –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Cloud Console –∏–ª–∏ gcloud
gcloud run services describe ai-bot --region=asia-southeast1 --format="value(spec.template.spec.template.spec.containers[0].env[].name,spec.template.spec.template.spec.containers[0].env[].value)"
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/debug` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
curl https://ai-bot-366461711404.asia-southeast1.run.app/debug
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–æ—á–Ω—ã–º**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—ã–π URL —Å `https://`
2. **–†–µ–≥–∏–æ–Ω –≤–∞–∂–µ–Ω**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–µ–≥–∏–æ–Ω –≤ URL —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–≥–∏–æ–Ω—É —Å–µ—Ä–≤–∏—Å–∞
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ**: –ö–æ–¥ —Ç–µ–ø–µ—Ä—å –ø—ã—Ç–∞–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å URL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–æ —Ä—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞
4. **–ë–µ–∑ keep-alive**: –ë–µ–∑ —ç—Ç–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç "–∑–∞—Å—ã–ø–∞—Ç—å" –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- ‚úÖ Keep-alive –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –±—É–¥–µ—Ç "–∑–∞—Å—ã–ø–∞—Ç—å"
- ‚úÖ –ù–µ –±—É–¥–µ—Ç "—Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞" –ø—Ä–∏ –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ –í –ª–æ–≥–∞—Ö –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ —É—Å–ø–µ—à–Ω—ã—Ö –ø–∏–Ω–≥–∞—Ö –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
