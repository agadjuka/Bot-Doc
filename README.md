# Telegram Bot Template

–ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Telegram –±–æ—Ç–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π AI (Google Gemini) –∏ –¥–µ–ø–ª–æ–µ–º –≤ Google Cloud Run.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements_local.txt

# 2. –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
cp .env.example .env

# 3. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ .env
# BOT_TOKEN=your_telegram_bot_token
# GEMINI_API_KEY=your_gemini_api_key
# PROJECT_ID=your_google_cloud_project_id

# 4. –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
python run_local.py
```

### Production –¥–µ–ø–ª–æ–π
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main –≤–µ—Ç–∫—É
git push origin main
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram-bot-template/
‚îú‚îÄ‚îÄ main.py                    # Production –≤–µ—Ä—Å–∏—è (FastAPI + webhook)
‚îú‚îÄ‚îÄ main_local.py             # –õ–æ–∫–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (polling)
‚îú‚îÄ‚îÄ run_local.py              # –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏
‚îú‚îÄ‚îÄ requirements.txt          # Production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ requirements_local.txt    # –õ–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ env.example              # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .env                     # –í–∞—à–∏ —Ç–æ–∫–µ–Ω—ã (—Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é)
‚îú‚îÄ‚îÄ config/                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ settings.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ secrets.py          # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ prompts.py          # AI –ø—Ä–æ–º–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ locales/            # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ ru.py          # –†—É—Å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ en.py          # –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ locale_manager.py  # –ú–µ–Ω–µ–¥–∂–µ—Ä –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ services/               # –°–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ ai_service.py      # AI —Å–µ—Ä–≤–∏—Å (Google Gemini)
‚îú‚îÄ‚îÄ handlers/              # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ message_handlers.py    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ callback_handlers.py   # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback'–æ–≤
‚îú‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ message_sender.py  # –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îî‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

| –†–µ–∂–∏–º | –§–∞–π–ª | –ü—Ä–æ—Ç–æ–∫–æ–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|------|----------|------------|
| **Production** | `main.py` | Webhook (FastAPI) | –î–µ–ø–ª–æ–π –≤ Google Cloud Run |
| **Local** | `main_local.py` | Polling | –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ |

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ
- `BOT_TOKEN` - –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `GEMINI_API_KEY` - API –∫–ª—é—á Google Gemini
- `PROJECT_ID` - ID –ø—Ä–æ–µ–∫—Ç–∞ Google Cloud

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ
- `FIRESTORE_DATABASE` - –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Firestore (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: default)
- `SERVICE_URL` - URL —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è keep-alive (–¥–ª—è Cloud Run)
- `GOOGLE_APPLICATION_CREDENTIALS` - –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Google Cloud
- `GOOGLE_APPLICATION_CREDENTIALS_JSON` - JSON —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è Cloud Run)

## üõ†Ô∏è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —à–∞–±–ª–æ–Ω–∞

- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã `/start` –∏ `/help`
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å AI –æ—Ç–≤–µ—Ç–∞–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç–∏ (—Ä—É—Å—Å–∫–∏–π/–∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Gemini AI
- ‚úÖ Firestore –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Keep-alive –¥–ª—è Cloud Run
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env`**
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: `pip install -r requirements_local.txt`
5. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ**: `python run_local.py`

## üöÄ –î–µ–ø–ª–æ–π –≤ Google Cloud Run

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ Google Cloud –ø—Ä–æ–µ–∫—Ç**
2. **–í–∫–ª—é—á–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ API** (Cloud Run, Firestore)
3. **–°–æ–∑–¥–∞–π—Ç–µ service account** —Å –Ω—É–∂–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –≤ Cloud Run
5. **–î–µ–ø–ª–æ–π—Ç–µ**: `gcloud run deploy`

## üîß –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
1. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ `handlers/message_handlers.py`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ `main.py` –∏–ª–∏ `main_local.py`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤
1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ `config/locales/` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `de.py`)
2. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–≤–æ–¥—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `LANG_TRANSLATIONS`
3. –û–±–Ω–æ–≤–∏—Ç–µ `locale_manager.py`

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ AI –ø–æ–≤–µ–¥–µ–Ω–∏—è
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç—ã –≤ `config/prompts.py`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ AI —Å–µ—Ä–≤–∏—Å –≤ `services/ai_service.py`

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ –¥–ª—è —Å–≤–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.