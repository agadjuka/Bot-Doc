# –°–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## –û–±–∑–æ—Ä

–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ Word –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏, –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Gemini AI.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. DocumentParserService (`services/document_parser_service.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º–∏ –∫–æ–º–ø–∞–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é Gemini AI

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `parse_company_info(text: str) -> dict` - –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–µ–∫—Å—Ç–∞

**–ò–∑–≤–ª–µ–∫–∞–µ–º—ã–µ –ø–æ–ª—è:**
- `COMPANY_FULL_NAME` - –ø–æ–ª–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏
- `COMPANY_SHORT_NAME` - –∫—Ä–∞—Ç–∫–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- `INN` - –ò–ù–ù
- `KPP` - –ö–ü–ü
- `OGRN` - –û–ì–†–ù
- `LEGAL_ADDRESS` - —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π –∞–¥—Ä–µ—Å
- `DIRECTOR_FULL_NAME` - –§–ò–û –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞
- `DIRECTOR_POSITION` - –¥–æ–ª–∂–Ω–æ—Å—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞

### 2. DocumentGeneratorService (`services/document_generator_service.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è .docx –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `fill_document(template_path: str, data: dict) -> bytes` - –∑–∞–ø–æ–ª–Ω—è–µ—Ç —à–∞–±–ª–æ–Ω –¥–∞–Ω–Ω—ã–º–∏
- `get_template_path(template_name: str) -> str` - –ø–æ–ª—É—á–∞–µ—Ç –ø—É—Ç—å –∫ —à–∞–±–ª–æ–Ω—É
- `create_sample_template(template_name: str) -> str` - —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω

### 3. DocumentHandler (`handlers/document_handler.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ Telegram –±–æ—Ç–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `new_contract_command()` - –∑–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `handle_company_info()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í Telegram –±–æ—Ç–µ

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É `/new_contract`
2. –ë–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç —Å —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º–∏
4. –ë–æ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç —Å –ø–æ–º–æ—â—å—é Gemini AI
5. –ë–æ—Ç —Å–æ–∑–¥–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç Word –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from services.document_parser_service import DocumentParserService
from services.document_generator_service import DocumentGeneratorService

# –ü–∞—Ä—Å–∏–Ω–≥ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
parser = DocumentParserService()
data = await parser.parse_company_info("—Ç–µ–∫—Å—Ç —Å —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º–∏")

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
generator = DocumentGeneratorService()
document_bytes = generator.fill_document("templates/template_test.docx", data)
```

## –®–∞–±–ª–æ–Ω—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ
–®–∞–±–ª–æ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ `templates/`

### –§–æ—Ä–º–∞—Ç –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–≤
–í —à–∞–±–ª–æ–Ω–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `{{FIELD_NAME}}`:
- `{{COMPANY_FULL_NAME}}`
- `{{INN}}`
- `{{LEGAL_ADDRESS}}`
- –∏ —Ç.–¥.

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —à–∞–±–ª–æ–Ω–∞
1. –°–æ–∑–¥–∞–π—Ç–µ .docx —Ñ–∞–π–ª –≤ –ø–∞–ø–∫–µ `templates/`
2. –í—Å—Ç–∞–≤—å—Ç–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –≤ –Ω—É–∂–Ω—ã–µ –º–µ—Å—Ç–∞
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π –∏–∑ DocumentParserService

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:
```bash
python test_document_system.py
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- `docxtpl==0.20.1` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —à–∞–±–ª–æ–Ω–∞–º–∏ Word
- `python-docx==1.2.0` - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤
- `google-generativeai==0.8.3` - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Gemini AI

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `GEMINI_API_KEY` - –∫–ª—é—á API –¥–ª—è Gemini AI

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
Bot-Doc/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ document_parser_service.py    # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∫–≤–∏–∑–∏—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ document_generator_service.py # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îî‚îÄ‚îÄ document_handler.py           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ template_test.docx            # –¢–µ—Å—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω
‚îú‚îÄ‚îÄ config/locales/
‚îÇ   ‚îú‚îÄ‚îÄ en.py                         # –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ru.py                         # –†—É—Å—Å–∫–∏–µ —Ç–µ–∫—Å—Ç—ã
‚îî‚îÄ‚îÄ test_document_system.py           # –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–ª–µ–¥—É—é—â–∏—Ö –æ—à–∏–±–æ–∫:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ GEMINI_API_KEY
- –û—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON –æ—Ç Gemini
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —à–∞–±–ª–æ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –û—à–∏–±–∫–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –û—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞ –≤ Telegram

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —ç–º–æ–¥–∑–∏:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚ùå –û—à–∏–±–∫–∏
- ‚è≥ –ü—Ä–æ—Ü–µ—Å—Å—ã –≤ —Ä–∞–±–æ—Ç–µ
- üìÑ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
