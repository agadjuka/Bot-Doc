# üöÄ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é –≤ Cloud Run

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏
–í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ! –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é.

## üìã –ß—Ç–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ

### ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –í—Å–µ –ø–∞–∫–µ—Ç—ã –∏–∑ `requirements.txt` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∞–Ω–∞–ª–∏–∑–∞:
  - `scikit-image==0.21.0`
  - `scipy==1.11.4`

### ‚úÖ –§–∞–π–ª—ã
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
- `main.py` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- `Dockerfile` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `cloudbuild.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
- `utils/receipt_analyzer.py` - –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏

### ‚úÖ –ò–º–ø–æ—Ä—Ç—ã
- –í—Å–µ –º–æ–¥—É–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

### ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `GEMINI_ANALYSIS_MODE=production`

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–µ–ø–ª–æ—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Cloud Run:
```bash
BOT_TOKEN=your_bot_token
PROJECT_ID=your_project_id
GOOGLE_APPLICATION_CREDENTIALS_JSON=your_credentials_json
GOOGLE_SHEETS_CREDENTIALS_JSON=your_sheets_credentials_json
DEFAULT_MODEL=pro
GOOGLE_CLOUD_LOCATION=global
GEMINI_ANALYSIS_MODE=production
```

### –†–µ—Å—É—Ä—Å—ã Cloud Run:
- **CPU**: 1
- **Memory**: 1Gi
- **Max instances**: 10
- **Min instances**: 0
- **Timeout**: 300s
- **Port**: 8080

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–ø–ª–æ—è

### 1. –ß–µ—Ä–µ–∑ Cloud Build (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```bash
gcloud builds submit --config cloudbuild.yaml
```

### 2. –ß–µ—Ä–µ–∑ gcloud –Ω–∞–ø—Ä—è–º—É—é:
```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
gcloud builds submit --tag gcr.io/PROJECT_ID/ai-bot

# –î–µ–ø–ª–æ–π –≤ Cloud Run
gcloud run deploy ai-bot \
  --image gcr.io/PROJECT_ID/ai-bot \
  --region us-central1 \
  --platform managed \
  --allow-unauthenticated \
  --port 8080 \
  --memory 1Gi \
  --cpu 1 \
  --max-instances 10 \
  --min-instances 0 \
  --timeout 300 \
  --set-env-vars "BOT_TOKEN=...,PROJECT_ID=...,GEMINI_ANALYSIS_MODE=production"
```

## üéØ –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ Gemini:
- **FLASH** (gemini-2.5-flash) - –¥–ª—è –ø–µ—á–∞—Ç–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- **PRO** (gemini-2.5-pro) - –¥–ª—è —Ä—É–∫–æ–ø–∏—Å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- **–¢–æ—á–Ω–æ—Å—Ç—å**: 81.2% (13/16 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–π)

### –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã:
- **Production** - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é
- **Debug** - —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** –≤ Cloud Run Console
2. **–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Ñ–æ—Ç–æ** –≤ –±–æ—Ç–∞
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏** –≤ –ª–æ–≥–∞—Ö
4. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ —Ä–∞–±–æ—Ç–µ** –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞**: 0.56 —Å–µ–∫—É–Ω–¥
- **–í—Ä–µ–º—è –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏**: ~0.4 —Å–µ–∫—É–Ω–¥—ã
- **–ü–∞–º—è—Ç—å**: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è Cloud Run
- **CPU**: —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ï—Å–ª–∏ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Cloud Run
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –ï—Å–ª–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `GEMINI_ANALYSIS_MODE=production`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–µ–π Gemini

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é! üéâ**
