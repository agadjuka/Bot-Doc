# Role System - Quick Start Guide

## Быстрый старт

### 1. Настройка администратора
Администратор уже настроен в конфигурации:
- ID: `261617302`
- Роль: `admin` (назначается автоматически при первом запуске)

### 2. Запуск бота
При первом запуске бота автоматически:
- Создается документ администратора с ролью "admin"
- Инициализируется система ролей

### 3. Управление доступом

#### Добавить пользователя в whitelist:
```
/add_whitelist username
```
Пример: `/add_whitelist john_doe`

#### Удалить пользователя из whitelist:
```
/remove_whitelist username
```
Пример: `/remove_whitelist john_doe`

#### Показать список пользователей в whitelist:
```
/list_whitelist
```

#### Открыть панель администратора:
```
/admin
```

### 4. Проверка доступа

Пользователи имеют доступ к боту, если:
- ✅ Они являются администраторами (role = "admin")
- ✅ Их username находится в whitelist

### 5. Структура данных

#### В коллекции `users`:
```json
{
  "role": "admin",  // или "user"
  "ingredient_list": [...],
  "language": "en"
}
```

#### В коллекции `whitelist`:
```
Документ ID: username (в нижнем регистре, без @)
Содержимое: пустой документ {}
```

## Команды для администратора

| Команда | Описание |
|---------|----------|
| `/admin` | Панель администратора |
| `/add_whitelist <username>` | Добавить в whitelist |
| `/remove_whitelist <username>` | Удалить из whitelist |
| `/list_whitelist` | Показать whitelist |

## Примеры использования

### Добавление пользователя в whitelist:
1. Пользователь сообщает свой username: `@john_doe`
2. Администратор выполняет: `/add_whitelist john_doe`
3. Пользователь получает доступ к боту

### Удаление пользователя из whitelist:
1. Администратор выполняет: `/remove_whitelist john_doe`
2. Пользователь теряет доступ к боту

### Проверка whitelist:
1. Администратор выполняет: `/list_whitelist`
2. Бот показывает список всех пользователей в whitelist

## Безопасность

- Только администраторы могут управлять whitelist
- Доступ к боту ограничен для неавторизованных пользователей
- Все операции логируются

## Тестирование

Запустите тест системы ролей:
```bash
python test_role_system.py
```

## Поддержка

При возникновении проблем:
1. Проверьте логи бота
2. Убедитесь, что Firestore подключен
3. Проверьте права доступа администратора
